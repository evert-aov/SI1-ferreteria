# CU-P01 – Importar Productos desde Excel

## Diagrama de Caso de Uso

```plantuml
@startuml cu-p01-importar
!theme plain

left to right direction

actor "Administrador" as Admin
actor "Empleado" as Empleado

rectangle "Sistema de Importación de Productos" {
    usecase "CU-P01: Importar Productos\ndesde Excel" as CU11
    usecase "CU-P02: Validar Formato\nde Archivo" as CU12
    usecase "CU-P03: Procesar Datos\ndel Archivo" as CU13
    usecase "CU-P04: Crear/Actualizar\nProductos" as CU14
    usecase "CU-P05: Ver Resultado\nde Importación" as CU15
}

Admin --> CU11
Empleado --> CU11

CU11 ..> CU12 : <<include>>
CU11 ..> CU13 : <<include>>
CU13 ..> CU14 : <<include>>
CU11 ..> CU15 : <<include>>

@enduml
```

## Especificación del Caso de Uso

| **Campo**         | **Descripción**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ----------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Caso de uso**   | CU-P01 – Importar Productos desde Excel                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **Propósito**     | • Permitir a administradores y empleados importar múltiples productos de forma masiva desde un archivo Excel, facilitando la carga inicial de inventario y actualizaciones masivas.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **Actores**       | • Administrador<br>• Empleado                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **Iniciador**     | • Administrador o Empleado                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **Precondición**  | • El usuario debe estar autenticado<br>• El usuario debe tener permisos de gestión de productos<br>• El archivo debe estar en formato Excel (.xlsx, .xls)<br>• Las categorías y marcas referenciadas deben existir                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **Flujo**         | **Vista de Importación**<br>1. El usuario accede a la sección de importación de productos<br>2. El usuario selecciona un archivo Excel de su computadora<br>3. El usuario hace clic en "Importar"<br>4. El sistema valida el formato y tamaño del archivo (máx 10MB)<br>5. El sistema lee el archivo Excel fila por fila<br>6. Para cada fila:<br>&nbsp;&nbsp;&nbsp;a. El sistema valida los datos (SKU, nombre, precio, stock, etc.)<br>&nbsp;&nbsp;&nbsp;b. El sistema busca la categoría y marca por nombre<br>&nbsp;&nbsp;&nbsp;c. El sistema busca si el producto existe por SKU<br>&nbsp;&nbsp;&nbsp;d. Si existe: actualiza los datos<br>&nbsp;&nbsp;&nbsp;e. Si no existe: crea un nuevo producto<br>&nbsp;&nbsp;&nbsp;f. Si hay errores: agrega a la lista de errores<br>7. El sistema genera un resumen con:<br>&nbsp;&nbsp;&nbsp;• Total de filas procesadas<br>&nbsp;&nbsp;&nbsp;• Productos creados exitosamente<br>&nbsp;&nbsp;&nbsp;• Productos actualizados<br>&nbsp;&nbsp;&nbsp;• Errores encontrados con detalles<br>8. El sistema muestra el resumen al usuario |
| **Postcondición** | • Los productos válidos son creados o actualizados en la base de datos<br>• Se genera un reporte de importación<br>• Los errores son reportados al usuario                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **Excepción**     | • Archivo con formato inválido<br>• Archivo demasiado grande (>10MB)<br>• Datos faltantes o inválidos en las filas<br>• Categoría o marca no encontrada<br>• SKU duplicado en el archivo<br>• Error de conexión a la base de datos<br>• Permisos insuficientes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
