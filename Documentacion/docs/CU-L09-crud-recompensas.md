# CU-L09 – Gestionar Recompensas CRUD

## Diagrama de Caso de Uso

```plantuml
@startuml cu-l09-crud-recompensas
!theme plain

left to right direction

actor "Administrador" as Admin

rectangle "Sistema de Lealtad - Administración" {
    usecase "CU-L09: Gestionar\nRecompensas CRUD" as CU9
    usecase "Crear Recompensa" as Create
    usecase "Editar Recompensa" as Edit
    usecase "Activar/Desactivar" as Toggle
    usecase "Eliminar Recompensa" as Delete
}

Admin --> CU9

CU9 ..> Create : <<include>>
CU9 ..> Edit : <<include>>
CU9 ..> Toggle : <<include>>
CU9 ..> Delete : <<include>>

@enduml
```

## Especificación del Caso de Uso

| **Campo**         | **Descripción**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ----------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Caso de uso**   | CU-L09 – Gestionar Recompensas CRUD                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **Propósito**     | • Permitir al administrador crear, editar, activar/desactivar y eliminar recompensas del programa de lealtad, controlando qué beneficios están disponibles para los clientes.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **Actores**       | • Administrador                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **Iniciador**     | • Administrador                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **Precondición**  | • El usuario debe tener rol de administrador<br>• El usuario debe estar autenticado                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **Flujo**         | **Crear Recompensa**<br>1. El administrador accede a la configuración de lealtad<br>2. El administrador hace clic en "Nueva Recompensa"<br>3. El sistema muestra el formulario vacío<br>4. El administrador completa los campos requeridos<br>5. El sistema valida los datos<br>6. El sistema guarda la imagen (si existe)<br>7. El sistema crea la recompensa en la base de datos<br><br>**Editar Recompensa**<br>1. El administrador hace clic en el botón "Editar"<br>2. El sistema carga los datos actuales en el formulario<br>3. El administrador modifica los campos deseados<br>4. El sistema valida los datos<br>5. El sistema actualiza la imagen (si cambió)<br>6. El sistema actualiza la recompensa<br><br>**Activar/Desactivar**<br>1. El administrador hace clic en el botón toggle<br>2. El sistema cambia el estado is_active<br>3. El sistema guarda el cambio<br><br>**Eliminar Recompensa**<br>1. El administrador hace clic en "Eliminar"<br>2. El sistema solicita confirmación<br>3. El sistema verifica que no tenga canjes asociados<br>4. El sistema elimina la imagen<br>5. El sistema elimina la recompensa |
| **Postcondición** | • La recompensa es creada/editada/eliminada según la operación<br>• Los cambios se reflejan en el catálogo de recompensas<br>• Se registra la acción en el sistema                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **Excepción**     | • Datos inválidos en el formulario<br>• Imagen demasiado grande (>2MB)<br>• Error al guardar en la base de datos<br>• Intentar eliminar recompensa con canjes activos<br>• Permisos insuficientes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
